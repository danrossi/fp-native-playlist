!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),i=flowplayer.events,n=flowplayer.util;i.PLAYLIST_CHANGED="playlistChanged",i.PLAYLIST_ITEM_CHANGE="playlistItemChange";var l=function(){function l(e,i){t(this,l),this.opts=e,this.video=i,this.config(0),this.video.index=0,this.addApi(i)}return e(l,[{key:"config",value:function(t){return n.extend(this.opts,this.playlistItem(t))}},{key:"playlistItem",value:function(t){return this.playlist[t]}},{key:"playItem",value:function(t){var e=this,n=this.video;if(void 0===t)return n.togglePlay();if("number"==typeof t){if(t===n.index)return void(n.currentTime=0);var l=this.config(t);n.once(i.LOAD_START,function(){e.onItemChange(t,l)}),n.setSrc(l.src)}}},{key:"nextItem",value:function(){var t=this.video.index;-1!=t&&(t=t===this.length?0:t+1,this.playItem(t))}},{key:"prevItem",value:function(){var t=this.video.index;-1!=t&&(t=0===t?this.length:t-1,this.playItem(t))}},{key:"addToPlaylist",value:function(t){delete this.video.is_last;var e=this.playlist;this.newPlaylist=e.concat([t])}},{key:"removeFromPlaylist",value:function(t){var e=this.playlist;this.newPlaylist=e.slice(0,t).concat(e.slice(t+1))}},{key:"onItemChange",value:function(t,e){var n=this.video;n.index=t,n.is_last=t==this.length,n.emit(i.PLAYLIST_ITEM_CHANGE,e),n.togglePlay()}},{key:"addApi",value:function(t){var e=this;t.playItem=function(t){return e.playItem(t)},t.next=function(){return e.nextItem},t.prev=function(){return e.prevItem},t.setPlaylist=function(t){return e.newPlaylist=t},t.addToPlaylist=function(t){return e.addToPlaylist(t)},t.removeFromPlaylist=function(t){return e.removeFromPlaylist(t)}}},{key:"playlist",get:function(){return this.opts.playlist},set:function(t){this.opts.playlist=t}},{key:"length",get:function(){return this.playlist.length-1}},{key:"newPlaylist",set:function(t){this.playlist=t,this.video.emit(i.PLAYLIST_CHANGED,this.playlist)}},{key:"index",get:function(){this.video.index}}]),l}();flowplayer(function(t,e,i){if(t.playlist){var n=flowplayer.events,a=new l(t,i);i.on(n.ENDED,function(){var e=void 0===t.advance||t.advance,i=a.index,n=a.length;if(e){var l=i>=0?i+1:void 0;l<n||t.loop?(l=l===n?0:l,a.playItem(l)):playlist.length>1&&a.playItem(0)}}),i.on(n.MOUNT,function(){i.emit(n.PLAYLIST_CHANGED,a.playlist)})}})});
